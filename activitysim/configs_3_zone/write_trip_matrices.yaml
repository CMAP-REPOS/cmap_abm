# read trips table post preprocessor and run expressions to code
# additional data fields, with one data fields for each matrix specified below

preprocessor:
  SPEC: write_trip_matrices_annotate_trips_preprocessor
  DF: trips
  TABLES:
    - tours
    - households

# divide trip counts by household expansion factor
HH_EXPANSION_WEIGHT_COL: sample_rate  # added when households read in

# save preprocessed trips table to pipeline if desired
SAVE_TRIPS_TABLE: True

MATRICES:
  #EA
  - file_name: trips_ea_taz.omx
    tables:
      - name: EA_SOV_NT_L
        data_field: SOV_NT_L_EA
      - name: EA_SOV_TR_L
        data_field: SOV_TR_L_EA
      - name: EA_HOV2_L
        data_field: HOV2_L_EA
      - name: EA_HOV3_L
        data_field: HOV3_L_EA
      - name: EA_SOV_NT_M
        data_field: SOV_NT_M_EA
      - name: EA_SOV_TR_M
        data_field: SOV_TR_M_EA
      - name: EA_HOV2_M
        data_field: HOV2_M_EA
      - name: EA_HOV3_M
        data_field: HOV3_M_EA
      - name: EA_SOV_NT_H
        data_field: SOV_NT_H_EA
      - name: EA_SOV_TR_H
        data_field: SOV_TR_H_EA
      - name: EA_HOV2_H
        data_field: HOV2_H_EA
      - name: EA_HOV3_H
        data_field: HOV3_H_EA
      - name: EA_WAL
        data_field: WALK_EA
      - name: EA_BIKE
        data_field: BIKE_EA
      - name: EA_SCHBUS
        data_field: SCHBUS_EA

  - file_name: trips_ea_low_tap.omx
    is_tap: True
    tables:       
      - name: EA_TRN_WALK_L
        data_field: TRN_WALK_LOW_EA
      - name: EA_TRN_PNR_L
        data_field: TRN_PNR_LOW_EA
      - name: EA_TRN_KNR_L
        data_field: TRN_KNR_LOW_EA
      - name: EA_TRN_TNC_L
        data_field: TRN_TNC_LOW_EA
      - name: TRNPerTrp_EA_L
        data_field: TRN_LOW_TOT_EA

  - file_name: trips_ea_mid_tap.omx
    is_tap: True
    tables:
      - name: EA_TRN_WALK_M    
        data_field: TRN_WALK_MID_EA
      - name: EA_TRN_PNR_M
        data_field: TRN_PNR_MID_EA
      - name: EA_TRN_KNR_M
        data_field: TRN_KNR_MID_EA
      - name: EA_TRN_TNC_M
        data_field: TRN_TNC_MID_EA
      - name: TRNPerTrp_EA_M
        data_field: TRN_MID_TOT_EA
 
  - file_name: trips_ea_hi_tap.omx
    is_tap: True
    tables: 
      - name: EA_TRN_WALK_H    
        data_field: TRN_WALK_HI_EA
      - name: EA_TRN_PNR_H
        data_field: TRN_PNR_HI_EA
      - name: EA_TRN_KNR_H
        data_field: TRN_KNR_HI_EA
      - name: EA_TRN_TNC_H
        data_field: TRN_TNC_HI_EA
      - name: TRNPerTrp_EA_H
        data_field: TRN_HI_TOT_EA
#AM
  - file_name: trips_am_taz.omx
    tables:
      - name: AM_SOV_NT_L
        data_field: SOV_NT_L_AM
      - name: AM_SOV_TR_L
        data_field: SOV_TR_L_AM
      - name: AM_HOV2_L
        data_field: HOV2_L_AM
      - name: AM_HOV3_L
        data_field: HOV3_L_AM
      - name: AM_SOV_NT_MM
        data_field: SOV_NT_M_AM
      - name: AM_SOV_TR_M
        data_field: SOV_TR_M_AM
      - name: AM_HOV2_M
        data_field: HOV2_M_AM
      - name: AM_HOV3_M
        data_field: HOV3_M_AM
      - name: AM_SOV_NT_H
        data_field: SOV_NT_H_AM
      - name: AM_SOV_TR_H
        data_field: SOV_TR_H_AM
      - name: AM_HOV2_H
        data_field: HOV2_H_AM
      - name: AM_HOV3_H
        data_field: HOV3_H_AM
      - name: AM_WALK
        data_field: WALK_AM
      - name: AM_BIKE
        data_field: BIKE_AM
      - name: AM_SCHBUS
        data_field: SCHBUS_AM
        
  - file_name: trips_am_low_tap.omx
    is_tap: True
    tables:       
      - name: AM_TRN_WALK_L
        data_field: TRN_WALK_LOW_AM
      - name: AM_TRN_PNR_L
        data_field: TRN_PNR_LOW_AM
      - name: AM_TRN_KNR_L
        data_field: TRN_KNR_LOW_AM
      - name: AM_TRN_TNC_L
        data_field: TRN_TNC_LOW_AM
      - name: TRNPerTrp_AM_L
        data_field: TRN_LOW_TOT_AM
  
  - file_name: trips_am_mid_tap.omx
    is_tap: True
    tables:     
      - name: AM_TRN_WALK_M
        data_field: TRN_WALK_MID_AM
      - name: AM_TRN_PNR_M
        data_field: TRN_PNR_MID_AM
      - name: AM_TRN_KNR_M
        data_field: TRN_KNR_MID_AM
      - name: AM_TRN_TNC_M
        data_field: TRN_TNC_MID_AM
      - name: TRNPerTrp_AM_M
        data_field: TRN_MID_TOT_AM

  - file_name: trips_am_hi_tap.omx
    is_tap: True
    tables: 
      - name: AM_TRN_WALK_H    
        data_field: TRN_WALK_HI_AM
      - name: AM_TRN_PNR_H
        data_field: TRN_PNR_HI_AM
      - name: AM_TRN_KNR_H
        data_field: TRN_KNR_HI_AM
      - name: AM_TRN_TNC_H
        data_field: TRN_TNC_HI_AM
      - name: TRNPerTrp_AM_H
        data_field: TRN_HI_TOT_AM
  #MM
  - file_name: trips_mm_taz.omx
    tables:
      - name: MM_SOV_NT_L
        data_field: SOV_NT_L_MM
      - name: MM_SOV_TR_L
        data_field: SOV_TR_L_MM
      - name: MM_HOV2_L
        data_field: HOV2_L_MM
      - name: MM_HOV3_L
        data_field: HOV3_L_MM
      - name: MM_SOV_NT_M
        data_field: SOV_NT_M_MM
      - name: MM_SOV_TR_M
        data_field: SOV_TR_M_MM
      - name: MM_HOV2_M
        data_field: HOV2_M_MM
      - name: MM_HOV3_M
        data_field: HOV3_M_MM
      - name: MM_SOV_NT_H
        data_field: SOV_NT_H_MM
      - name: MM_SOV_TR_H
        data_field: SOV_TR_H_MM
      - name: MM_HOV2_H
        data_field: HOV2_H_MM
      - name: MM_HOV3_H
        data_field: HOV3_H_MM
      - name: MM_WALK
        data_field: WALK_MM
      - name: MM_BIKE
        data_field: BIKE_MM
      - name: MM_SCHBUS
        data_field: SCHBUS_MM

  - file_name: trips_mm_low_tap.omx
    is_tap: True
    tables:                
      - name: MM_TRN_WALK_L
        data_field: TRN_WALK_LOW_MM
      - name: MM_TRN_PNR_L
        data_field: TRN_PNR_LOW_MM
      - name: MM_TRN_KNR_L
        data_field: TRN_KNR_LOW_MM
      - name: MM_TRN_TNC_L
        data_field: TRN_TNC_LOW_MM
      - name: TRNPerTrp_MM_L
        data_field: TRN_LOW_TOT_MM

  - file_name: trips_mm_mid_tap.omx
    is_tap: True
    tables:                
      - name: MM_TRN_WALK_M
        data_field: TRN_WALK_MID_MM
      - name: MM_TRN_PNR_M
        data_field: TRN_PNR_MID_MM
      - name: MM_TRN_KNR_M
        data_field: TRN_KNR_MID_MM
      - name: MM_TRN_TNC_M
        data_field: TRN_TNC_MID_MM
      - name: TRNPerTrp_MM_M
        data_field: TRN_MID_TOT_MM
        
  - file_name: trips_mm_hi_tap.omx
    is_tap: True
    tables:                
      - name: MM_TRN_WALK_H
        data_field: TRN_WALK_HI_MM
      - name: MM_TRN_PNR_H
        data_field: TRN_PNR_HI_MM
      - name: MM_TRN_KNR_H
        data_field: TRN_KNR_HI_MM
      - name: MM_TRN_TNC_H
        data_field: TRN_TNC_HI_MM
      - name: TRNPerTrp_MM_H
        data_field: TRN_HI_TOT_MM
  # #MD
  - file_name: trips_md_taz.omx
    tables:
      - name: MD_SOV_NT_L
        data_field: SOV_NT_L_MD
      - name: MD_SOV_TR_L
        data_field: SOV_TR_L_MD
      - name: MD_HOV2_L
        data_field: HOV2_L_MD
      - name: MD_HOV3_L
        data_field: HOV3_L
      - name: MD_SOV_NT_M
        data_field: SOV_NT_M_MD
      - name: MD_SOV_TR_M
        data_field: SOV_TR_M_MD
      - name: MD_HOV2_M
        data_field: HOV2_M_MD
      - name: MD_HOV3_M
        data_field: HOV3_M_MD
      - name: MD_SOV_NT_H
        data_field: SOV_NT_H_MD
      - name: MD_SOV_TR_H
        data_field: SOV_TR_H_MD
      - name: MD_HOV2_H
        data_field: HOV2_H_MD
      - name: MD_HOV3_H
        data_field: HOV3_H_MD
      - name: MD_WALK
        data_field: WALK_MD
      - name: MD_BIKE
        data_field: BIKE_MD
      - name: MD_SCHBUS
        data_field: SCHBUS_MD
 
  - file_name: trips_md_low_tap.omx
    is_tap: True
    tables:                
      - name: MD_TRN_WALK_L
        data_field: TRN_WALK_LOW_MD
      - name: MD_TRN_PNR_L
        data_field: TRN_PNR_LOW_MD
      - name: MD_TRN_KNR_L
        data_field: TRN_KNR_LOW_MD
      - name: MD_TRN_TNC_L
        data_field: TRN_TNC_LOW_MD
      - name: TRNPerTrp_MD_L
        data_field: TRN_LOW_TOT_MD

  - file_name: trips_md_mid_tap.omx
    is_tap: True
    tables:                
      - name: MD_TRN_WALK_M
        data_field: TRN_WALK_MID_MD
      - name: MD_TRN_PNR_M
        data_field: TRN_PNR_MID_MD
      - name: MD_TRN_KNR_M
        data_field: TRN_KNR_MID_MD
      - name: MD_TRN_TNC_M
        data_field: TRN_TNC_MID_MD
      - name: TRNPerTrp_MD_M
        data_field: TRN_MID_TOT_MD
        
  - file_name: trips_md_hi_tap.omx
    is_tap: True
    tables:                
      - name: MD_TRN_WALK_H
        data_field: TRN_WALK_HI_MD
      - name: MD_TRN_PNR_H
        data_field: TRN_PNR_HI_MD
      - name: MD_TRN_KNR_H
        data_field: TRN_KNR_HI_MD
      - name: MD_TRN_TNC_H
        data_field: TRN_TNC_HI_MD
      - name: TRNPerTrp_MD_H
        data_field: TRN_HI_TOT_MD

  #AF
  - file_name: trips_af_taz.omx
    tables:
      - name: AF_SOV_NT_L
        data_field: SOV_NT_L_AF
      - name: AF_SOV_TR_L
        data_field: SOV_TR_L_AF
      - name: AF_HOV2_L
        data_field: HOV2_L_AF
      - name: AF_HOV3_L
        data_field: HOV3_L_AF
      - name: AF_SOV_NT_M
        data_field: SOV_NT_M_AF
      - name: AF_SOV_TR_M
        data_field: SOV_TR_M_AF
      - name: AF_HOV2_M
        data_field: HOV2_M_AF
      - name: AF_HOV3_M
        data_field: HOV3_M_AF
      - name: AF_SOV_NT_H
        data_field: SOV_NT_H_AF
      - name: AF_SOV_TR_H
        data_field: SOV_TR_H_AF
      - name: AF_HOV2_H
        data_field: HOV2_H_AF
      - name: AF_HOV3_H
        data_field: HOV3_H_AF
      - name: AF_WALK
        data_field: WALK_AF
      - name: AF_BIKE
        data_field: BIKE_AF
      - name: AF_SCHBUS
        data_field: SCHBUS_AF
     
  - file_name: trips_af_low_tap.omx
    is_tap: True
    tables:                
      - name: AF_TRN_WALK_L
        data_field: TRN_WALK_LOW_AF
      - name: AF_TRN_PNR_L
        data_field: TRN_PNR_LOW_AF
      - name: AF_TRN_KNR_L
        data_field: TRN_KNR_LOW_AF
      - name: AF_TRN_TNC_L
        data_field: TRN_TNC_LOW_AF
      - name: TRNPerTrp_AF_L
        data_field: TRN_LOW_TOT_AF

  - file_name: trips_af_mid_tap.omx
    is_tap: True
    tables:                
      - name: AF_TRN_WALK_M
        data_field: TRN_WALK_MID_AF
      - name: AF_TRN_PNR_M
        data_field: TRN_PNR_MID_AF
      - name: AF_TRN_KNR_M
        data_field: TRN_KNR_MID_AF
      - name: AF_TRN_TNC_M
        data_field: TRN_TNC_MID_AF
      - name: TRNPerTrp_AF_M
        data_field: TRN_MID_TOT_AF
        
  - file_name: trips_af_hi_tap.omx
    is_tap: True
    tables:                
      - name: AF_TRN_WALK_H
        data_field: TRN_WALK_HI_AF
      - name: AF_TRN_PNR_H
        data_field: TRN_PNR_HI_AF
      - name: AF_TRN_KNR_H
        data_field: TRN_KNR_HI_AF
      - name: AF_TRN_TNC_H
        data_field: TRN_TNC_HI_AF
      - name: TRNPerTrp_AF_H
        data_field: TRN_HI_TOT_AF

  #PM
  - file_name: trips_pm_taz.omx
    tables:
      - name: PM_SOV_NT_L
        data_field: SOV_NT_L_PM
      - name: PM_SOV_TR_L
        data_field: SOV_TR_L_PM
      - name: PM_HOV2_L
        data_field: HOV2_L_PM
      - name: PM_HOV3_L
        data_field: HOV3_L_PM
      - name: PM_SOV_NT_M
        data_field: SOV_NT_M_PM
      - name: PM_SOV_TR_M
        data_field: SOV_TR_M_PM
      - name: PM_HOV2_M
        data_field: HOV2_M_PM
      - name: PM_HOV3_M
        data_field: HOV3_M_PM
      - name: PM_SOV_NT_H
        data_field: SOV_NT_H_PM
      - name: PM_SOV_TR_H
        data_field: SOV_TR_H_PM
      - name: PM_HOV2_H
        data_field: HOV2_H_PM
      - name: PM_HOV3_H
        data_field: HOV3_H_PM
      - name: PM_WALK
        data_field: WALK_PM
      - name: PM_BIKE
        data_field: BIKE_PM
      - name: PM_SCHBUS
        data_field: SCHBUS_PM

  - file_name: trips_pm_low_tap.omx
    is_tap: True
    tables:                
      - name: PM_TRN_WALK_L
        data_field: TRN_WALK_LOW_PM
      - name: PM_TRN_PNR_L
        data_field: TRN_PNR_LOW_PM
      - name: PM_TRN_KNR_L
        data_field: TRN_KNR_LOW_PM
      - name: PM_TRN_TNC_L
        data_field: TRN_TNC_LOW_PM
      - name: TRNPerTrp_PM_L
        data_field: TRN_LOW_TOT_PM

  - file_name: trips_pm_mid_tap.omx
    is_tap: True
    tables:                
      - name: PM_TRN_WALK_M
        data_field: TRN_WALK_MID_PM
      - name: PM_TRN_PNR_M
        data_field: TRN_PNR_MID_PM
      - name: PM_TRN_KNR_M
        data_field: TRN_KNR_MID_PM
      - name: PM_TRN_TNC_M
        data_field: TRN_TNC_MID_PM
      - name: TRNPerTrp_PM_M
        data_field: TRN_MID_TOT_PM
        
  - file_name: trips_pm_hi_tap.omx
    is_tap: True
    tables:                
      - name: PM_TRN_WALK_H
        data_field: TRN_WALK_HI_PM
      - name: PM_TRN_PNR_H
        data_field: TRN_PNR_HI_PM
      - name: PM_TRN_KNR_H
        data_field: TRN_KNR_HI_PM
      - name: PM_TRN_TNC_H
        data_field: TRN_TNC_HI_PM
      - name: TRNPerTrp_PM_H
        data_field: TRN_HI_TOT_PM

  #EV
  - file_name: trips_ev_taz.omx
    tables:
      - name: EV_SOV_NT_L
        data_field: SOV_NT_L_EV
      - name: EV_SOV_TR_L
        data_field: SOV_TR_L_EV
      - name: EV_HOV2_L
        data_field: HOV2_L_EV
      - name: EV_HOV3_L
        data_field: HOV3_L_EV
      - name: EV_SOV_NT_M
        data_field: SOV_NT_M_EV
      - name: EV_SOV_TR_M
        data_field: SOV_TR_M_EV
      - name: EV_HOV2_M
        data_field: HOV2_M_EV
      - name: EV_HOV3_M
        data_field: HOV3_M_EV
      - name: EV_SOV_NT_H
        data_field: SOV_NT_H_EV
      - name: EV_SOV_TR_H
        data_field: SOV_TR_H_EV
      - name: EV_HOV2_H
        data_field: HOV2_H_EV
      - name: EV_HOV3_H
        data_field: HOV3_H_EV
      - name: EV_WALK
        data_field: WALK_EV
      - name: EV_BIKE
        data_field: BIKE_EV
      - name: EV_SCHBUS
        data_field: SCHBUS_EV
                
  - file_name: trips_ev_low_tap.omx
    is_tap: True
    tables:                
      - name: EV_TRN_WALK_L
        data_field: TRN_WALK_LOW_EV
      - name: EV_TRN_PNR_L
        data_field: TRN_PNR_LOW_EV
      - name: EV_TRN_KNR_L
        data_field: TRN_KNR_LOW_EV
      - name: EV_TRN_TNC_L
        data_field: TRN_TNC_LOW_EV
      - name: TRNPerTrp_EV_L
        data_field: TRN_LOW_TOT_EV

  - file_name: trips_ev_mid_tap.omx
    is_tap: True
    tables:                
      - name: EV_TRN_WALK_M
        data_field: TRN_WALK_MID_EV
      - name: EV_TRN_PNR_M
        data_field: TRN_PNR_MID_EV
      - name: EV_TRN_KNR_M
        data_field: TRN_KNR_MID_EV
      - name: EV_TRN_TNC_M
        data_field: TRN_TNC_MID_EV
      - name: TRNPerTrp_EV_M
        data_field: TRN_MID_TOT_EV
        
  - file_name: trips_ev_hi_tap.omx
    is_tap: True
    tables:                
      - name: EV_TRN_WALK_H
        data_field: TRN_WALK_HI_EV
      - name: EV_TRN_PNR_H
        data_field: TRN_PNR_HI_EV
      - name: EV_TRN_KNR_H
        data_field: TRN_KNR_HI_EV
      - name: EV_TRN_TNC_H
        data_field: TRN_TNC_HI_EV
      - name: TRNPerTrp_EV_H
        data_field: TRN_HI_TOT_EV

  #NT
  - file_name: trips_nt_taz.omx
    tables:
      - name: NT_SOV_NT_L
        data_field: SOV_NT_L_NT
      - name: NT_SOV_TR_L
        data_field: SOV_TR_L_NT
      - name: NT_HOV2_L
        data_field: HOV2_L_NT
      - name: NT_HOV3_L
        data_field: HOV3_L_NT
      - name: NT_SOV_NT_M
        data_field: SOV_NT_M_NT
      - name: NT_SOV_TR_M
        data_field: SOV_TR_M_NT
      - name: NT_HOV2_M
        data_field: HOV2_M_NT
      - name: NT_HOV3_M
        data_field: HOV3_M_NT
      - name: NT_SOV_NT_H
        data_field: SOV_NT_H_NT
      - name: NT_SOV_TR_H
        data_field: SOV_TR_H_NT
      - name: NT_HOV2_H
        data_field: HOV2_H_NT
      - name: NT_HOV3_H
        data_field: HOV3_H_NT
      - name: NT_WALK
        data_field: WALK_NT
      - name: NT_BIKE
        data_field: BIKE_NT
      - name: NT_SCHBUS
        data_field: SCHBUS_NT

  - file_name: trips_nt_low_tap.omx
    is_tap: True
    tables:                
      - name: NT_TRN_WALK_L
        data_field: TRN_WALK_LOW_NT
      - name: NT_TRN_PNR_L
        data_field: TRN_PNR_LOW_NT
      - name: NT_TRN_KNR_L
        data_field: TRN_KNR_LOW_NT
      - name: NT_TRN_TNC_L
        data_field: TRN_TNC_LOW_NT
      - name: TRNPerTrp_NT_L
        data_field: TRN_LOW_TOT_NT

  - file_name: trips_nt_mid_tap.omx
    is_tap: True
    tables:                
      - name: NT_TRN_WALK_M
        data_field: TRN_WALK_MID_NT
      - name: NT_TRN_PNR_M
        data_field: TRN_PNR_MID_NT
      - name: NT_TRN_KNR_M
        data_field: TRN_KNR_MID_NT
      - name: NT_TRN_TNC_M
        data_field: TRN_TNC_MID_NT
      - name: TRNPerTrp_NT_M
        data_field: TRN_MID_TOT_NT
        
  - file_name: trips_nt_hi_tap.omx
    is_tap: True
    tables:                
      - name: NT_TRN_WALK_H
        data_field: TRN_WALK_HI_NT
      - name: NT_TRN_PNR_H
        data_field: TRN_PNR_HI_NT
      - name: NT_TRN_KNR_H
        data_field: TRN_KNR_HI_NT
      - name: NT_TRN_TNC_H
        data_field: TRN_TNC_HI_NT
      - name: TRNPerTrp_NT_H
        data_field: TRN_HI_TOT_NT


CONSTANTS:
  time_periods:
    #  periods: [0, 4, 5, 7, 8, 12, 14, 16, 18, 24]
    #labels: &skim_time_period_labels ['VE', 'EA', 'AM', 'MM', 'MD', 'AF', 'PM', 'EV', 'NT']
    # VE = 3a - 6a (same skim data as NT)
    # EA = 6a - 7a
    # AM = 7a - 9a
    # MM = 9a - 10a
    # MD = 10a - 2p
    # AF = 2p - 4p
    # PM = 4p - 6p
    # EV = 6p - 8p
    # NT = 8p - 3a
    VE:
      first_hour: 0
      last_hour: 3
    EA:
      first_hour: 4
      last_hour: 4
    AM:
      first_hour: 5
      last_hour: 6
    MM:
      first_hour: 7
      last_hour: 7
    MD:
      first_hour: 8
      last_hour: 11
    AF:
      first_hour: 12
      last_hour: 13
    PM:
      first_hour: 14
      last_hour: 15
    EV:
      first_hour: 16
      last_hour: 17
    NT:
      first_hour: 18
      last_hour: 24
      
  # SHARED2 and SHARED3 Occupancies
  OCC_SHARED2: 2.0
  OCC_SHARED3: 3.33
